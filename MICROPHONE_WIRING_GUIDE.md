# ESP32-S3 麥克風接線說明

## 🎙️ I2S 麥克風模組接線

### 推薦的 I2S 麥克風模組

- **INMP441** (最常用，性能好)
- **MAX9814**
- **SPH0645**

### 接線配置 (根據 main.cpp 設定)

```
ESP32-S3 引腳    I2S 麥克風模組    說明
─────────────────────────────────────────
GPIO18          WS (或 LR)      字選擇信號 (Word Select)
GPIO19          SD (或 DATA)    音頻數據輸入 (Serial Data)  
GPIO20          SCK (或 BCLK)   位時鐘信號 (Bit Clock)
3.3V            VDD (或 VCC)    電源正極
GND             GND             電源負極 & 接地
不接             L/R             左右聲道選擇 (接GND=左聲道)
```

## 🔌 INMP441 麥克風模組接線圖

```
     INMP441                    ESP32-S3
   ┌─────────────┐            ┌─────────────┐
   │             │            │             │
   │ VDD     ────┼────────────┼──── 3.3V    │
   │ GND     ────┼────────────┼──── GND     │  
   │ L/R     ────┼────────────┼──── GND     │ (左聲道)
   │ WS      ────┼────────────┼──── GPIO18  │
   │ SCK     ────┼────────────┼──── GPIO20  │
   │ SD      ────┼────────────┼──── GPIO19  │
   │             │            │             │
   └─────────────┘            └─────────────┘
```

## 🎛️ 麥克風控制按鈕接線

```
ESP32-S3 引腳    按鈕配置         說明
─────────────────────────────────────────
GPIO42          按鈕 -> GND      麥克風開關控制
```

按鈕接線：

```
GPIO42 ────┬──── 按鈕一端
           │
           └──── 10kΩ上拉電阻 ──── 3.3V
                      │
            按鈕另一端 ──── GND
```

*註：ESP32 內建上拉電阻，外部上拉電阻可選*

## 📋 完整接線列表

| ESP32-S3 引腳 | 連接對象 | 功能說明 |
|---------------|----------|----------|
| GPIO18 | 麥克風 WS | I2S 字選擇信號 |
| GPIO19 | 麥克風 SD | I2S 音頻數據 |
| GPIO20 | 麥克風 SCK | I2S 位時鐘 |
| GPIO42 | 控制按鈕 | 麥克風開關 |
| 3.3V | 麥克風 VDD | 電源 |
| GND | 麥克風 GND, L/R, 按鈕 | 接地 |

## ⚠️ 注意事項

1. **電源電壓**: 使用 3.3V，不要接 5V
2. **接地共用**: 所有 GND 必須連接在一起
3. **L/R 引腳**: 接 GND 選擇左聲道，接 VDD 選擇右聲道
4. **引腳衝突**: 確認 GPIO18, 19, 20 沒有被其他功能占用

## 🛒 購買建議

### INMP441 規格

- **靈敏度**: -26dBFS
- **信噪比**: 61dB
- **頻率響應**: 60Hz-15kHz
- **電源**: 1.8V-3.3V
- **尺寸**: 約 15x13mm

### 購買連結範例 (台灣)

- 蝦皮搜尋: "INMP441 麥克風模組"
- 電子材料行: "I2S 數位麥克風"
- 價格範圍: NT$80-150

## 🔧 測試步驟

1. **硬體檢查**

   ```bash
   # 用三用電表檢查連接
   - 3.3V 到麥克風 VDD: 應有 3.3V 電壓
   - GND 連接: 應為 0Ω 電阻
   - 信號線: 檢查是否有短路
   ```

2. **軟體測試**

   ```bash
   # 串口監控，檢查初始化
   pio device monitor
   
   # 應該看到：
   # ✓ 麥克風 I2S 設定成功
   # 麥克風任務啟動
   ```

3. **功能測試**  
   - 按下 GPIO42 按鈕
   - OLED 顯示 "Mic: ON"
   - 對著麥克風說話，串口應有數據輸出

## 🐛 常見問題

1. **初始化失敗**
   - 檢查 3.3V 電源供應
   - 確認接線無誤
   - 檢查 GPIO 引腳是否被占用

2. **無音頻數據**
   - 檢查 SD 引腳連接
   - 確認 L/R 引腳接地
   - 檢查麥克風模組是否損壞

3. **音質差**
   - 檢查電源穩定性
   - 避免引腳間串擾
   - 確認接地良好

## 📱 OLED 顯示測試

正常工作時 OLED 應顯示：

```
System Status
Uptime: 123s  
RAM: 234kB
WiFi: Connected
Audio: Playing Vol:12  Mic: ON
```

按下麥克風控制按鈕，"Mic: ON" 應切換為 "Mic: OFF"。
